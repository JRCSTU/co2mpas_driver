<html>
 <body>
  <div>
   <input onclick="window.history.back()" type="button" value="Back"/>
   <input onclick="window.history.forward()" type="button" value="Forward"/>
  </div>
  <html>
   <body>
    <div class="highlight" style="background: #f8f8f8">
     <pre style="line-height: 125%"><span></span><span style="color: #AA22FF">@sh</span><span style="color: #666666">.</span>add_function(dsp, outputs<span style="color: #666666">=</span>[<span style="color: #BA2121">'raw_data'</span>], input_domain<span style="color: #666666">=</span>check_ext)
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">read_excel</span>(input_path):
    <span style="color: #BA2121; font-style: italic">"""</span>
<span style="color: #BA2121; font-style: italic">    Read input file.</span>

<span style="color: #BA2121; font-style: italic">    :param input_path:</span>
<span style="color: #BA2121; font-style: italic">        Input file path.</span>
<span style="color: #BA2121; font-style: italic">    :type input_path: str</span>

<span style="color: #BA2121; font-style: italic">    :return:</span>
<span style="color: #BA2121; font-style: italic">        Raw data of input file.</span>
<span style="color: #BA2121; font-style: italic">    :rtype: dict</span>
<span style="color: #BA2121; font-style: italic">    """</span>
    <span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">xlrd</span>
    <span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">pandas</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">pd</span>
    raw_data <span style="color: #666666">=</span> {}
    <span style="color: #008000; font-weight: bold">with</span> pd<span style="color: #666666">.</span>ExcelFile(input_path) <span style="color: #008000; font-weight: bold">as</span> xl:
        <span style="color: #008000; font-weight: bold">for</span> k <span style="color: #AA22FF; font-weight: bold">in</span> (<span style="color: #BA2121">'inputs'</span>, <span style="color: #BA2121">'config'</span>, <span style="color: #BA2121">'vehicle_inputs'</span>, <span style="color: #BA2121">'time_series'</span>):
            <span style="color: #008000; font-weight: bold">try</span>:
                <span style="color: #008000; font-weight: bold">if</span> k <span style="color: #666666">==</span> <span style="color: #BA2121">'time_series'</span>:
                    raw_data[k] <span style="color: #666666">=</span> xl<span style="color: #666666">.</span>parse(k)<span style="color: #666666">.</span>dropna(<span style="color: #666666">1</span>)<span style="color: #666666">.</span>to_dict(orient<span style="color: #666666">=</span><span style="color: #BA2121">'list'</span>)
                <span style="color: #008000; font-weight: bold">else</span>:
                    df <span style="color: #666666">=</span> xl<span style="color: #666666">.</span>parse(k, header<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">None</span>, index_col<span style="color: #666666">=0</span>, usecols<span style="color: #666666">=</span>[<span style="color: #666666">0</span>, <span style="color: #666666">1</span>])<span style="color: #666666">.</span>T
                    raw_data[k] <span style="color: #666666">=</span> df<span style="color: #666666">.</span>dropna(<span style="color: #666666">1</span>)<span style="color: #666666">.</span>to_dict(orient<span style="color: #666666">=</span><span style="color: #BA2121">'records'</span>)[<span style="color: #666666">0</span>]
            <span style="color: #008000; font-weight: bold">except</span> <span style="color: #D2413A; font-weight: bold">IndexError</span>:
                log<span style="color: #666666">.</span>warning(<span style="color: #BA2121">'Sheet `</span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BA2121">` is not well formatted!'</span> <span style="color: #666666">%</span> k)
            <span style="color: #008000; font-weight: bold">except</span> xlrd<span style="color: #666666">.</span>biffh<span style="color: #666666">.</span>XLRDError:
                log<span style="color: #666666">.</span>warning(<span style="color: #BA2121">'Missing sheet (`</span><span style="color: #BB6688; font-weight: bold">%s</span><span style="color: #BA2121">`)!'</span> <span style="color: #666666">%</span> k)

    <span style="color: #008000; font-weight: bold">return</span> raw_data
</pre>
    </div>
   </body>
  </html>
 </body>
</html>